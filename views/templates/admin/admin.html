{% extends 'base.html' %}
{% block style %}
    <style>
        main {
            width: 100%;
            height: 700px;
        }
        .request {
            border: 1px solid blue;
            margin: 70px auto;
            width: 1300px;
            height: 500px;
            background-color: white;
            box-shadow: 0 15px 30px 0 black;
            text-align: center;
            font-size: 15px;
        }

        /* 모달 */
        #acceptModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1;
            border-radius: 15px;
        }

        #regectModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1;
            border-radius: 15px;
        }

        /* 어두운 배경 생성 */
        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 0;
        }

        #acceptModal > div > p {
            display: inline-block;
            font-size: 20px;
        }

    </style>
{% endblock %}
{% block main %}
    <main>
        <div class="request">
            <h2>방문자 관리 페이지</h2>
            <form name="dataForm">
                <table class="table-bordered container mt-4 " >
                    <tr>
                        <th>NO</th>
                        <th>접수시간</th>
                        <th>회사이름</th>
                        <th>부서명</th>
                        <th>직급</th>
                        <th>이름</th>
                        <th>전화번호</th>
                        <th>담당자(보안등급)</th>
                        <th>방문목적</th>
                        <th>방문장소(보안등급)</th>
                        <th>방문날짜</th>
                        <th>접수상태</th>
                        <th>
                            승인/거절
                        </th>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>2024.04.05 12:19</td>
                        <td>삼성전자</td>
                        <td>기획부</td>
                        <td>부장</td>
                        <td>서승재</td>
                        <td>010-1234-5678</td>
                        <td>재정부 과장 김모씨(2)</td>
                        <td>업무미팅</td>
                        <td>2층 다목적실B(3)</td>
                        <td>2024-04-17</td>
                        <td>N(접수 중)</td>
                        <td>
                            <button onclick="openModal1(this)" type="button" class="btn btn-primary">승인</button>
                            <button onclick="openModal2()" type="button" class="btn btn-danger">거절</button>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>2024.04.05 12:19</td>
                        <td>삼성전자</td>
                        <td>기획부</td>
                        <td>부장</td>
                        <td>차승원</td>
                        <td>010-1234-5678</td>
                        <td>재정부 대리 김모씨(3)</td>
                        <td>업무미팅</td>
                        <td>2층 기획실(2)</td>
                        <td>2024-04-17</td>
                        <td>R(거절)</td>
                        <td>
                            거절완료
                        </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>2024.04.05 12:19</td>
                        <td>삼성전자</td>
                        <td>기획부</td>
                        <td>부장</td>
                        <td>김신록</td>
                        <td>010-1234-5678</td>
                        <td>재정부 대리 김모씨(1)</td>
                        <td>업무미팅</td>
                        <td>2층 기획실(2)</td>
                        <td>2024-04-17</td>
                        <td>Y(승인)</td>
                        <td>
                            승인완료
                        </td>
                    </tr>
                </table>
            </form>
        </div>

        <div id="acceptModal" style="z-index: 10">
            <div style="display: none" id="number">01</div>
            <div>
                <p id="accept_name">OOO</p><p>의 출입을 허가하시겠습니까?</p>
            </div>
            <div>
                <table class="table table-borderd">
                    <tr>
                        <th colspan="4">출입자</th>
                    </tr>
                    <tr>
                        <th>회사</th>
                        <th>부서</th>
                        <th>직급</th>
                        <th>이름</th>
                    </tr>
                    <tr>
                        <td id="company">컴퍼니</td>
                        <td id="visit_depart">기획부</td>
                        <td id="visit_posit">부장</td>
                        <td id="visit_name">서승재</td>
                    </tr>
                </table>
                <table>
                    <tr>
                        <th colspan="4">담당자</th>
                    </tr>
                    <tr>
                        <th >부서</th>
                        <th >직급</th>
                        <th>이름</th>
                        <th>보안등급</th>
                    </tr>
                    <tr>
                        <td id="emp_depart">부서</td>
                        <td id="emp_posit">직급</td>
                        <td id="emp_name">이름</td>
                        <td id="emp_sg">보안등급</td>
                    </tr>
                    <tr>
                        <th colspan="2">방문목적</th>
                        <th>방문장소</th>
                        <th>보안등급</th>
                    </tr>
                    <tr>
                        <td colspan="2" id="purpose">업무미팅</td>
                        <td id="location">다목적실B</td>
                        <td id="loc_sg">2</td>
                    </tr>
                </table>
            </div>
            <div>
                <button onclick="closeModal1()" type="button">이전</button>
                <button type="button" id="accept_btn">승인</button>
            </div>
        </div>
        <div id="overlay"></div>
    </main>
{% endblock %}

{% block script %}
<script>
let openModal1 = (button) => {

    let row = button.parentNode.parentNode;

    document.getElementById("number").innerText = row.cells[0].innerText;
    document.getElementById("accept_name").innerText = row.cells[5].innerText;
    document.getElementById("company").innerText = row.cells[2].innerText;
    document.getElementById("visit_depart").innerText = row.cells[3].innerText;
    document.getElementById("visit_posit").innerText = row.cells[4].innerText;
    document.getElementById("visit_name").innerText = row.cells[5].innerText;

    let data1 = row.cells[3].innerText;
    let parts = data.split(' ');
    let depart = parts[0];
    let position = parts[1];
    let name = parts[2].slice(0, -3);
    let sg = parts[2].slice(-2, -1);

    document.getElementById("emp_depart").innerText = depart;
    document.getElementById("emp_posit").innerText = position;
    document.getElementById("emp_name").innerText = name;
    document.getElementById("emp_sg").innerText = sg;


    document.getElementById("acceptModal").style.display = "block";
    document.getElementById("overlay").style.display = "block";
}

let openModal2 = () => {
    document.getElementById("regectModal").style.display = "block";
    document.getElementById("overlay").style.display = "block";
}

let closeModal1 = () => {
    document.getElementById("acceptModal").style.display = "none";
    document.getElementById("overlay").style.display = "none";
}

let closeModal2 = () => {
    document.getElementById("regectModal").style.display = "none";
    document.getElementById("overlay").style.display = "none";
}

let accept_btn = document.querySelector('#accept_btn');

accept_btn.addEventListener('click', () => {
    let jsondata = {};
})
</script>
{% endblock %}